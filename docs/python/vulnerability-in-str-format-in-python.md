# Python 中 str.format()的漏洞

> 原文:[https://www . geesforgeks . org/python 中的 str 格式漏洞/](https://www.geeksforgeeks.org/vulnerability-in-str-format-in-python/)

**先决条件:**[Python–format()函数](https://www.geeksforgeeks.org/python-format-function/)

**str.format()** 是 Python3 中的字符串格式化方法之一，允许多次替换和值格式化。这个方法允许我们通过位置格式化来连接字符串中的元素。这似乎是一件很酷的事情。但是当我们的 Python 应用程序在用户控制的字符串中使用 str.format 时，这个漏洞就出现了。此漏洞可能导致攻击者获取敏感信息。

**注意:**此问题已在
举报 [str 格式漏洞](https://python-forum.io/Thread-str-format-security-vulnerability)

那么这怎么会成为一个弱点呢？让我们看看下面的例子

**示例:**

```py
# Let us assume this CONFIG holds some sensitive information
CONFIG = {
    "KEY": "ASXFYFGK78989"
}

class PeopleInfo:
    def __init__(self, fname, lname):
        self.fname = fname
        self.lname = lname

def get_name_for_avatar(avatar_str, people_obj):
    return avatar_str.format(people_obj = people_obj)

# Driver Code
people = PeopleInfo('GEEKS', 'FORGEEKS')

# case 1: st obtained from user
st = input()
get_name_for_avatar(st, people_obj = people)
```

**情况 1:**
当用户给出以下字符串作为输入时

```py
Avatar_{people_obj.fname}_{people_obj.lname}
```

**输出:**

```py
Avatar_GEEKS_FORGEEKS
```

**情况 2:**
当用户输入以下字符串作为输入时

```py
{people_obj.__init__.__globals__[CONFIG][KEY]}
```

**输出:**

```py
ASXFYFGK78989
```

这是因为 ***字符串格式化函数也可以访问属性对象*** ，这可能会泄露数据。现在可能会出现一个问题。使用 str.format()不好吗？。不，但是当它在用户控制的字符串上使用时会变得脆弱。